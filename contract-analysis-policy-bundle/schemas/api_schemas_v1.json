{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Contract Analysis API Schemas (v1)",
  "version": "v1",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "AnalysisRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "contract_id": { "type": "string" },
        "contract_uri": { "type": "string" },
        "fdot_contract": { "type": "boolean" },
        "assume_fdot_year": { "type": "string", "pattern": "^\\d{4}$" },
        "policy_version": { "type": "string" },
        "notes": { "type": "string" }
      },
      "required": ["contract_id", "fdot_contract"]
    },

    "SubmissionResponse": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "run_id": { "type": "string" },
        "status": { "$ref": "#/$defs/SubmissionStatus" },
        "queued_at": { "type": "string", "format": "date-time" }
      },
      "required": ["run_id", "status", "queued_at"]
    },

    "AnalysisResult": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "run_id": { "type": "string" },
        "status": { "$ref": "#/$defs/CompletionStatus" },
        "completed_at": { "type": "string", "format": "date-time" },
        "manifest": { "type": "object", "additionalProperties": true },
        "error": { "type": "object", "additionalProperties": true }
      },
      "required": ["run_id", "status", "completed_at", "manifest"]
    }
  },
  "required": ["AnalysisRequest", "SubmissionResponse", "AnalysisResult"],
  "$defs": {
    "SubmissionStatus": { "type": "string", "enum": ["queued", "started", "error"] },
    "CompletionStatus": { "type": "string", "enum": ["completed", "failed"] }
  }
}
