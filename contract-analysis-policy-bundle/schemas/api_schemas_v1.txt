{
  // =====================================================================
  // APS Contract Analysis â€” API Schemas v1
  // File: contract-analysis-policy-bundle/schemas/api_schemas_v1.json
  // Purpose: Defines request/response contracts for the orchestrator API.
  // =====================================================================

  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "APS API I/O Schemas",
  "version": "1.0",

  "definitions": {
    // ---------------------------------------------------------------
    // Request to run an analysis
    // ---------------------------------------------------------------
    "AnalysisRequest": {
      "type": "object",
      "required": ["contract_id", "contract_uri", "fdot_contract"],
      "additionalProperties": false,
      "properties": {
        "contract_id": { "type": "string" },    // Unique ID in APS system
        "contract_uri": { "type": "string" },   // Where the contract doc is stored
        "fdot_contract": { "type": "boolean" }, // Operator pre-flags FDOT or not
        "assume_fdot_year": {                   // Optional override for year
          "type": ["string", "null"]
        },
        "policy_version": { "type": "string" }, // Which rulebook version to apply
        "notes": { "type": "string" }           // Free-form operator notes
      }
    },

    // ---------------------------------------------------------------
    // Response acknowledging run submission
    // ---------------------------------------------------------------
    "SubmissionResponse": {
      "type": "object",
      "required": ["run_id", "status", "queued_at"],
      "additionalProperties": false,
      "properties": {
        "run_id": { "type": "string" },   // Assigned run identifier
        "status": {
          "type": "string",
          "enum": ["queued", "started", "error"]
        },
        "queued_at": { "type": "string" } // UTC ISO timestamp
      }
    },

    // ---------------------------------------------------------------
    // Response after run completion
    // ---------------------------------------------------------------
    "AnalysisResult": {
      "type": "object",
      "required": ["run_id", "status", "completed_at", "manifest"],
      "additionalProperties": false,
      "properties": {
        "run_id": { "type": "string" },
        "status": {
          "type": "string",
          "enum": ["completed", "failed"]
        },
        "completed_at": { "type": "string" }, // UTC ISO timestamp
        "manifest": {
          "$ref": "run_manifest_schema_v1.json" // Embeds schema defined separately
        },
        "error": {
          "type": "object",
          "required": ["code", "message"],
          "properties": {
            "code": { "type": "string" },
            "message": { "type": "string" }
          }
        }
      }
    }
  }
}
